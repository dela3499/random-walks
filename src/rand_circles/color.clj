(ns rand-circles.color
  (:require [clojure.string :refer [split]]
            [rand-circles.util :refer [string-to-float]]))

;; [Adobe Kuler](https://color.adobe.com) provides a fast, interactive way to select color schemes. As you explore different options, the url is updated to reflect the colors you've selected. I've pasted and parsed a number of these below.

(defn parse-kuler-url
  "Given a string url, return a list of RGB values (themselves 3-element lists.)"
  [url]
  (->> url
      (re-find #"rgbvalues=(.*)&swatchOrder")
      (#(nth % 1))
      (#(split % #","))
      (map string-to-float)
      (map #(* 255 %))
      (partition 3)))

(def kuler-urls
  ["https://color.adobe.com/create/color-wheel/?base=3&rule=Monochromatic&selected=1&name=My%20Color%20Theme&mode=rgb&rgbvalues=1,1,1,0.007918733758563676,0.13505272703720764,0.16431372549019613,0.10980392156862745,0.6039215686274509,0.7176470588235294,0.31951807228915663,0.8057390548913937,0.9176470588235295,0.029766123316796626,0.5076564321804343,0.6176470588235294,0.020127569099929153,0.34327244461724615,0.41764705882352954&swatchOrder=1,3,2,0,4"

  "https://color.adobe.com/create/color-wheel/?base=3&rule=Monochromatic&selected=3&name=My%20Color%20Theme&mode=rgb&rgbvalues=0.4066666666666667,0.2596139230884888,0.019598393574297206,0.8833333333333333,0.5990896747929055,0.1351548269581056,0.44235294117647045,0.31120321991081035,0.09714417531718567,0.86,0.5490196078431373,0.04144578313253016,0.6599999999999999,0.4213406292747604,0.03180722891566268,1,1,1&swatchOrder=1,3,2,0,4"

  "https://color.adobe.com/create/color-wheel/?base=3&rule=Monochromatic&selected=3&name=My%20Color%20Theme&mode=rgb&rgbvalues=0.18338535414172807,0.3152941176470589,0.017001229407425628,0.4973372027963519,0.7919607843137255,0.1257115015602658,0.23074661667833857,0.35098039215686266,0.07908882712073723,0.4470588235294118,0.7686274509803922,0.04144578313253016,0.33073229291729556,0.5686274509803921,0.030661421194984023&swatchOrder=1,3,2,0,4"

  "https://color.adobe.com/create/color-wheel/?base=3&rule=Complementary&selected=4&name=My%20Color%20Theme&mode=rgb&rgbvalues=0.4686274509803922,0.31902604331445644,0.012634620113105488,1,0.7224200037850999,0.1539218096877305,0,0.17937800070405646,0.4686274509803922,0.7686274509803922,0.5300548380469997,0.04144578313253013,0.2627450980392157,0.45638327453134514,0.7686274509803922&swatchOrder=1,3,2,0,4"

  "https://color.adobe.com/create/color-wheel/?base=3&rule=Triad&selected=2&name=My%20Color%20Theme&mode=rgb&rgbvalues=0.318399152221312,0.4686274509803922,0.07213198532425019,0.1242440751400962,0.3244275613327357,0.8071895424836601,0.5686274509803921,0.3003751020440592,0.24234924695801538,0.4931053471682004,0.7686274509803922,0.04144578313253013,0.4686274509803922,0.08485249869608935,0.0018378676771913438&swatchOrder=1,3,2,0,4"])

(def colors
  (mapcat parse-kuler-url kuler-urls))